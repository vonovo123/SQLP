# 결합 인덱스 구성을 위한 기본 공식

인덱스 스캔 방식에 여러 가지가 있찌만 가장 정상적이고 일반적인 것은 INDEX RANGE SCAN 이다.
이를 위해서는 인덱스 선두 칼럼이 조건절에 반드시 사용돼야만 한다. 따라서 결합 인덱스를 구성할 때 첫 번째 기준은 ,
조건절에 항상 사용되거나 적어도 자주 사용되는 칼럼을 선정하는 것이다.

두 번째 기준은, 그렇게 선정된 칼럼중 '=' 조건으로 자주 조회되는 칼럼을 앞쪽에 두는 것이다.

세 번째 기준은, 소트 오퍼레이션을 생략하도록 하기 위해 칼럼을 추가하는 것이다. 인덱스는 항상 정렬 상태를 유지하므로
ORDERBY, GROUPBY를 위한 소트 연산을 생략할 수 있도록 해준다. 따라서 조건절에 사용되지 않은 칼럼이라도
소트연산을 대체할 목적으로 인덱스 구서에 포함하여 성능 개선을 도모할 수 있다. 인덱스를 이용해 소트 연산을 대체하려면, 인덱스 칼럼과 같은 순서로 누락없이
ORDYERBY 절에 기술해 줘야 한다. 단 인덱스 구성 칼럼이 조건절에서 = 연산자로 비교된다면 ORDER BY 절에서 누락되거나 인덱스와 다른 순서로 기술하더라도 상관없다.

- 선택도 이슈

인덱스 생성 여부를 결정할 때는 선택도가 충분히 낮은지가 중요한 판단 기준이 된다.
인덱스를 스캔하면서 테이블을 액세스하는 양이 일정 수준을 넘기는 순간 FULL TABLE SCAN 보다 오히려 느려지기 때문이다.
따라서 선택도가 높은 인덱스를 생성해봐야 효용가치가 없다.
결합 인덱스 칼럼 간 순서를 정할 때도 개별 칼럼의 선택도가 고려사항은 될 수 있지만, 어느 쪽이 유리한지는 상황에 따라 다르다.
개별 칼럼의 선택도 보다는 조건절에서 어떤 형태로 자주 사용되는지, 사용빈도는 어느 쪽이 높은지, 데이터를 빠르게 검색하는 데에 어느 쪽 효용성이 높은지 등이 중요한 판단기준이다.

---

# 추가적인 고려사항

위 공식이 결합 인덱스를 구성할 때 일반적으로 통용될 수 있는 기본임은 틀림 없다. 하지만 인덱스 설계가 그렇게 간단하지만은 않다,
인덱스 스캔의 효율성 외에도 고려해야 할 요소들이 훨씬 많다.

- 쿼리 수행 빈도
- 업무 상 중요도
- 클러스터링 팩터
- 데이터량
- DML 부하
- 저장공간
- 인덱스 관리비용

인덱스 설계는 공식이 아닌 전략과 선택의 문제다. 시스템의 전체적인 관점에서 대안전략들을 수립하고, 그 중 최적을 선택할 수 있는 고도의 기술력과 경험이 요구된다.
개발 쿼리 성능을 높일 뿐만 아니라 생성되는 인덱스 개수를 최소화함으로써 DML 부하를 줄이는 것이 중요하다.
