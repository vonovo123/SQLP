# 관계의 개념

## 관계의 정의

엔터티의 인스턴스 사이의 논리적인 연관성으로서 존재하는 형태로서나 행위로서 서로에게 연관성이 부여된 상태.
엔터티와 엔터티 간 연관성을 표현하기 때문에 엔터티의 정의에 따라 영향을 받기도 하고, 속성 정의 및 관계 정의에 따라 다양하게 변할 수 있다.

## 관계의 패어링

관계는 엔터티 안의 인스턴스가 개별적으로 관계를 가지는 것으로(패어링), 이것의 집합을 관계로 표현한다.
개별 인스턴스가 각각 다른 종류의 관계를 가지고 있다면, 두 엔터티 사이에 두 개 이상의 관계가 형성될 수 있다.
각각의 엔터터의 인스턴스는 자신이 관련된 인스턴스와 관계가 발생하는데 이를 관계 패어링이라 한다.
관계의 표현에는 이항 관계, 삼항 관계, n항 관계가 존재할 수 있다.
인스턴스 각각은 자신의 연관성을 가지고 있을 수 있다.

이런 연관성을 집합하여 관계를 도출한다

---

# 관계의 분류

관계는 존재에 의한 관계와 행위에 의한 관계로 구분될 수 있다. 이는 관계 연결의 목적에 따라 분류한 것이다.

[관계의분류](./%EA%B4%80%EA%B3%84%EC%9D%98%EB%B6%84%EB%A5%98.jpeg)

예를들어 '소속된다'는 누군가가 집단에 소속되어있기 때문에 나타나는 존재의 형태에 의해 관계가 형성되는 것이다. 반대로 '주문한다'는 인스턴스의 행위에 의해 발생한다.

---

# 관계의 표기법

다음의 3가지 개념을 통해 표기법을 이해할 수 있다.

\- 관계명
\- 관계차수
\- 관계선택사양

## 관계명

관계명은 엔터티가 관계에 참여하는 형태를 지정한다. 각각의 관계는 두 개의 관계명을 가지고 있다. 각각의 관계명에 의해 두 가지 관점으로 표현될 수 있다.
엔터티에서 관계가 시작되는 쪽을 '관계시작점' 이라고 부르고, 받는 편을 '관계끝점' 이라고 한다. 관계 시작점과 끝점 모두 관계이름을 가져야하고, 참여자의 관점에 따라 관계이름이 능동적이거나 수동적으로 명명된다.

\- 애매한 동사의 사용을 피한다.
\- 현재형으로 표현한다

## 관계차수

두 개의 엔터티간 관계에서 참여자 수를 표현하는 것을 관계차수라고 한다. 가장 일반적은 관계차수 표현 방법은 1:M, 1:1, M:N 이 있다.
가장 중요하게 고려해야 할 사항은 한 개의 관계가 존재하느냐 아니면 두 개 이상의 관계가 존재하느냐를 파악하는 것 이다.

### 1:1

- 관계에 참여하는 각각의 엔터티는 관계를 맺는 다른 엔터티의 인스턴스에 대해 단지 하나의 관계만을 가진다.

### 1:M

- 관계에 참여하는 각각의 엔터티는 관계를 맺는 다른 엔터티의 인스턴스에 대해 하나나 그 이상의 수와 관계를 가지고 있다. 그러나 반대 방향은 단지 하나만의 관계를 가진다.

### M:M

- 관계에 참여하는 각각의 엔터티는 다른 엔터티의 인스턴스에 대해 하나나 그 이상의 수와 관계를 가진다. 반대의 방향도 마찬가지이다.
- 두 개의 주 식별자를 상속받은 관계엔터티를 이용해 3개의 엔터티로 구분하여 표현할 수 있다.

## 관계선택사양

관계의 선택사양에는 필수참여와 선택참여가 있다.
핌수참여는 참여하는 모든 참여자가 반드시 관계를 가지는, 타 엔터티의 참여자와 연결되어야하는 관계이다. 예를들어 주문서는 반드시 주문목록을 가져야 하며 주문목록이 없는 주문서는 의미가 없다. 주문서와 주문목록은 필수참여관계가 된다.

반대로 목록은 주문이 될 수도 있고 주문이 되지 않을 수도 있으므로 목록과 주문목록과의 관계는 선택참여가 된다. 선택참여된 항목은 물리속성에서 외래키로 연결 또는 Null을 허용할 수 있는 항목이 된다. 만약 선택참여로 지정해야 할 관계를 필수참여로 지정하면 애플리케이션에서 데이터가 발생할 때 반드시 한 개의 트랜잭션으로 제어해야하는 제약사항이 발생한다. 선택참여관계는 ERD 관계선에서 선택참여하는 엔터티 쪽을 원으로 표현한다. 필수참여는 아무런 표시하지 않는다. 만약 관계가 표시된 양쪽 엔터티에 모두 선택참여가 표시된다면 0:0 관계이므로 관계설정이 잘못되었는지 검토해봐야한다.

관계선택사양은 관계를 통해 상대방과의 업무적인 제약조건을 표현하는 것으로 간단하면서도 중요한 표기법이다. 이에 따라 참조무결성 제약조건의 규칙이 바뀌므로 주의 깊게 모델링해야한다.

---

# 관계의 정의 및 읽는 방법

## 관계 체크사항

\- 두 개의 엔터티 사이에 관심 있는 연관규칙이 존재하는가?
\- 두 개의 엔터티 사이에 정보의 조합이 발생하는가?
\- 업무기술서, 장표에 관계연결에 대한 규칙이 서술되어있는가?
\- 업무 기술서, 장표에 관계연결을 가능하게하는 동사가 있는가?

## 관계 읽기

데이터 모델을 읽는 방법은 먼저 관계에 참여하는 기준 엔터티를 하나 또는 각(Each)로 읽고, 대상 엔터티의 개수를 읽고 관계선택사양과 관계명을 읽는다.

\- 기준 엔터티를 한 개 또는 각 으로 읽는다.
\- 대상 엔터티의 관계참여도, 즉 개수를 읽는다.
\- 관계선택사양과 관계명을 읽는다.

```shell

# 각/하나의 # 기준엔터티  #관계차수 #관련엔터티 #선택사양 #관계명

# 각각의  사원은  한  부서에  때때로  속한다.
# 각  부서는 여러  사원을  항상  소속한다.

```

앞의 관계를 정의한 사항에 대해 뒷부분만 의문문으로 바꾸면 관계를 도출하기 위한 질문 문장으로 바꿀 수 있다. 이런 질문 방법은 엔터티 간 관계설정뿐 아니라 업무의 흐름도 분석되는 효과적인 방법이다.
