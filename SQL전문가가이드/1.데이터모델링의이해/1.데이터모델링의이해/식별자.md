# 개념

여러 인스턴스를 담고 있는 엔터티에서 각각의 인스턴스를 구분할 수 있는 논리적 이름을 식별자라고 한다.
식별자란 하나의 엔터티에 구성된 여러 개의 속성 중에 엔터티를 대표할 수 있는 속성을 의미하며, 하나의 엔터티는 반드시 하나의 유일한 식별자가 존재해야한다.
식별자라는 용어는 업무적으로 구분되는 정보로 논리 데이터 모델링 단계에서 사용되고 키는 데이터베이스 테이블에 접근을 위한 매개체로 물리 데이터 모델링 단계에서 사용된다.

---

# 특징

주식별자인자 아니면 외부 식별자인지에 따라 특성이 다소 차이가 있다.

주식별자는 다음과 같은 특징을 갖는다.서울 북카페 광화문 북카페 독서모임하기 좋은 카페 추천 광화문 북카페 에무(cafe emu) 방문후기

\- 유일성 : 주식별자에 의해 엔터티 내에 모든 인스턴스들이 유일하게 구분되어야 한다.
\- 최소성 : 주식별자를 구성하는 속성의 수는 유일성을 만족하는 최소의 수가 되어야한다.
\- 불변성 : 지정된 주 식별자의 값은 자주 변하지 않는 것이어야 한다.
\- 존재성: 주식별자로 지정되면 반드시 값이 존재해야한다.

외부식별자의 경우 주식별자 특징과 일치하지 않으며 참조무결성 제약조건에 따른 특징을 가지고 있다.

---

# 식별자 분류 및 표기법

## 식별자의 분류

식별자의 종류는 자신의 엔터티 내에서 대표성을 가지는가에 따라 '주식별자' 와 '보조식별자'로 구분한다.

엔터티 내에서 스스로 생성되었는지 여부에 따라 '내부식별자' 와 '외부식별자'로 구분할 수 있다.

단일 속성으로 식별 되는가에 따라 '단일식별자' 와 '복합식별자' 로 구분할 수 있다.

원래 업무적으로 의미가 있던 식별자 속성을 대체하여 일련번호와 같이 새롭게 만든 식별자를 구분하기 위해 '본질식별자' 와 '인조식별자'로 구분할 수 있다.

## 식별자 표기법

[식별자의 분류 데이터모델](./%EC%8B%9D%EB%B3%84%EC%9E%90%EC%9D%98%20%EB%B6%84%EB%A5%98-%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%AA%A8%EB%8D%B8.png)

---

# 주식별자 도출기준

주식별자를 도출하기 위한 기준을 정리하면 다음과 같다.

\- 해당 업무에서 자주 이용되는 속성을 주식별자로 지정한다.
\- 명칭, 내역 등과 같이 이름으로 기술되는 것들은 가능하면 주식별자로 지정하지 않는다.
\- 복합으로 주식별자를 구성할 경우 너무 많은 속성이 포함되지 않도록 한다.

## 해당 업무에서 자주 이용되는 속성을 주식별자로 지정

예를들어 직원이라는 엔터티가 있을 때, 유일하게 식별 가능한 속성으로 주민등록번호와 사원번호가 존재할 수 있다. 회사에서 더 흔하게 사용되는 사원번호를 주식별자로 하고, 주민등록번호는 보조식별자로 사용할 수 있다.

## 명칭, 내역등 이름으로 기술되는 것들은 주식별자로 지정하지 않는다.

예를 들어 부서 이름을 주식별자로 선정하면 물리데이터베이스로 테이블을 생성하여 데이터를 읽을 때 항상 부서 이름이 WHERE 조건절에 기술되는 현상이 발생한다. 부서 이름은 20자 이상이 될 수 있으므로 조건절에 정확한 부서 이름을 기술하는 것은 쉽지않다.
이처럼 명칭이나 내역 이외에 인스턴스를 식별할 수 있는 다른 구분자가 존재하지 않을 경우 새로운 식별자를 생성하는 것이 좋다. 보통 일련번호와 코드를 많이 사용한다.

## 복합으로 주식별자를 구성할 경우 너무 많은 속성이 포함되지 않도록 한다.

일반적으로 주식별자의 속성의 개수가 많다는 것은 새로운 인조식별자를 생성하여 데이터 모델을 구성하는 것이 데이터 모델을 한층 더 단순하게 하고, 조건절을 단순하게 할 수 있는 방법이 될 수 있다.
만약 주식별자가 선정된 자신이 가지고 있는 자식엔터티로부터 손자, 증손자엔터티까지 계속해 상승되는 속성이고, 복잡한 데이터 모델이 구현되어 물리적데이터베이스에서 조인으로 인해 성능 저하가 예상된다면
반정규화 측면에서 하나의 테이블에 많은 속성이 있는 것이 인정될 수 있다.

---

# 식별자관계와 비식별자관계에 따른 식별자

## 식별자관계와 비식별자관계의 결정

'외부식별자'는 자기 자신의 엔터티에서 필요한 속성이 아니라 다른 엔터티와의 관계를 통해 자식쪽에 엔터티에 생성되는 속성을 말한다.
데이터베이스 생성 시에 Foreign Key 역할을 한다.
관계의 속성을 정의하고 주식별자를 정의하면, 논리적 관계에 의해 자연스럽게 외부식별자가 도출되지만 중요한 고려사항이 있다.
엔터티에 주 식별자가 지정되고 엔터티 간 관계를 연결하면 부모쪽의 주 식별자를 자식엔터티의 속성으로 내려보낸다. 이때 자식엔터티에서 부모엔터티로부터 받은
외부식별자를 자신의 주식별자로 이용할 것인지 부모와의 연결 속성으로만 이용할 것인지 결정해야한다.

## 식별자관계

부모로부터 받은 식별자를 자식엔터티의 주식별자로 이용하는 경우 Null 값이면 안 되므로 반드시 부모엔터티가 생성되어야 자기 자신의 엔터티가 생성되는 경우이다.
부모로부터 받은 속성을 자식엔터티가 모두 사용하고 그것만으로 주식별자로 사용하면, 부모엔터티와 자식엔터티의 관계는 1:1이 된다.
만약 부모로부터 받은 속성을 포함해 다른 부모엔터티에서 받은 속성을 포함하거나 스스로 가진 속성과 함께 주식별자를 구성하는 경우 1:M 관계가 된다.

예를들어 발령엔터티는 반드시 사원엔터티가 있어야 자신도 생성될 수 있고, 자신의 주식별자도 부모엔터티의 외부식별자 '사원번호' 와 자신의 속성 발령번호로 이루어져 있다.
이때 사원과 발령의 관계는 1:M이다.

사원과 임시직사원의 관계를 보면 임시직 사원의 주식별자는 사원의 주식별자와 동일하다. 이는 1:1 관계이다. 주식별자가 동일하며 엔터티 통합의 대상이 된다.

이와같이 자식엔터티의 주식별자로 부모의 주식별자가 상속되는 경우 '식별자관계'라고 한다.

## 비식별자관계

부모엔터티로부터 속성을 받았찌만 주식별자로 사용하지 않고 일반적인 속성으로만 사용하는경우가 있다. 이를 '비식별자관계'라고 하며 다음과 같은 네가지 경우 비식별자관계에 의한 외부속성을 생성한다.

- 자식엔터티에서 받은 속성이 반드시 필수가 아니어도 무방하므로 부모 없는 자식이 생성될 수 있는 경우.

- 엔터티별로 데이터의 생명주기를 다르게 관리할 경우. 예를 들어 부모엔터티에 인스턴스가 자식의 엔터티와 관계를 가지고 있지만 먼저 소멸될 수 있는 경우에 해당한.

- 여러 개의 엔터티가 하나의 엔터티로 통합, 표현되었는데 각각의 엔터티가 별도의 관계를 가질 때
  예를들어 인터넷접수, 내방접수, 전화접수 엔터티를 하나로 통합하여 접수 에터티를 표현한 경우 통합된 엔터티가 각각의 엔터티가 별도의 관계를 가지고 있고, 각각의 관계로부터 받은 주 식별자를 줏식별자로 사용할 수 없다.

- 자식엔터티에 주식별자로 사용하여도 되지만 자식엔터티에서 별도의 주 식별자를 생성하는 것이 유리하다고 판단될때

## 식별자 관계로만 설정할 경우의 문제점

식별자관계와 비식별자관계에 대한 설정을 고려하지 않으면 개발 복잡성을 증가시킨다.

원시 엔티티인 PLAN 의 경우 단지 한개의 속성만이 PK 속성이다. 하지만 EQPEVISTSHST 엔터티는 부모로 부터 모두 식별자관계 연결로 인해 PK 속성의 개수가 5개가 된다.
원시 엔터티에는 PK 속성 수가 1개이고 관계가 1:M으로 전개되면 자식엔터티의 주식별자의 수는 부모의 PK 속성수 + 1개가 된다.
1개 이상의 속성이 추가되어야 1:M 관계를 만족할 수 있기 때문이다. 이와 같은 원리에 따라 지속적으로 식별자 관계를 연결한 데이터 모들의 PK속성 수는 데이터 모델의 흐름이 길어질수록 증가할 수 밖에 없다.

최종 부모 엔터티로 만들어진 자식 엔터티는 PK 속성 수가 많은 데이터 모델로 만들 수밖에 없다.

PK의 수가 과도해지면 조인 시 조건절이 매우 길어진다. 데이터 모델을 참조하면서 엔터티와 관계를 이용해 개발할때 생성된 엔터티 스키마 정보만 보고 개발하는 경우가 많다. 위와 같이 조인에 참여하는 주식별자속성의 수가 많을 경우 정확하게 조인관계를 설정하는데 어려움이 발생한다.

## 비식별자관계로만 설정할 경우 문제점

일반적으로 각각의 엔터티에는 주요한 기준 속성이 있다. 기준속성은 부모엔터티에 있는 PK 속성으로부터 상속되어 자식엔터티에 존재하는 경우가 많다.
이런 속성은 부모엔터티를 조회할 때 말고도 자식엔터티의 데이터를 조회할 때도 사용한다. 데이터 모델링을 전개할 때 각 엔터티 간의 관계를 비식별자관계로 설정하면 이런 유형의 속성이 자식엔터티로 상속되지 않아 자식엔터티를 처리할때 부모엔터티까지 찾아야가하는 경우가 발생한다. 이때 불필요한 조인이 유발되면서 구문도 길어지고 성능이 저하되는 현상이 발생한다.

식별자관계를 통해 연결하면 부모의 모든 주식별자 속성을 상속받음으로인해 맨 하우에 있는 자식엔터티에서 바로 조회 조건을 이용해 원하는 정보를 가져올 수 있다. 이 경우 성능과 개발용이성 측면에서 우위를 갖는다.

## 식별자관계와 비식별자관계 모델링

### 비식별자관계 선택 프로세스

식별자 관계와 비식별자관계를 취사선택하여 연결하는 것은 높은 수준의 기술을 요한다.
기본적으로 식별자관계로 모든 관계가 연결되면서 다음 조건에 해당할 경우 비식별자관계로 조정한다.

\- 관계의 강약분석을 후 약한 관계로 판단되는 겨우
\- 자식테이블의 독립 PK가 필요한 겨우
\- SQL 복잡도 증가로 개발생산성 저하가 우려되는 경우

### 식별자와 비식별자관계 비교

#### 식별자 관계

\- 강한 연결관계를 표현한다
\- 자식 주식별자의 구성에 포함된다
\- 실선으로 표현된다.
\- 자식 엔터티는 부모엔터티에 종속된다.
\- 자식 주식별자구성에 부모 주식별자가 포함된다.
\- 상속받은 주식별자속성을 타 엔터티에 이전한다

#### 비식별자 관계

\- 약한 연결관계를 표현하다.
\- 자식의 일반속성에 부모의 주식별자가 포함된다
\- 점선으로 표현된다
\- 약한 종속관계를가진다
\- 자식의 주식별자를 독립적으로 구성하다
\- 자식 주식별자 구성에 부모 주식별자가 부분적으로 필요하다
\- 상속받은 주식별자속성을 타 엔터티에서 차단한다
\- 부모쪽의 관계참여가 선택관계이다.
