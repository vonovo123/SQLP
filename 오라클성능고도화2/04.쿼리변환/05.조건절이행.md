조건절 이행은 a=b 고 b=c 이면 a=c이다 라는 추론을 통해 새로운 조건절을 내부적으로 생성해주는 쿼리변환이다.

예를들어 A 테이블에 사용된 필터 조건이 조인 조건절을 타고 반대편 b 테이블에 대한 필터 조건으로 이행될 수 있다.

한 테이블 내에서도 두 컬럼 간 관계정보를 이용해 조건절이 이행된다.

```sql
select *
from dept d, emp e
where e.job = 'MANAGER'
and e.deptno = 10
and d.deptno = e.deptno
```

deptno = 10 은 emp 테이블에 대한 필터 조건이다.

하지만 아래 실행계획에 나타나는 Predicate 정보를 확인해 보면, dept 테이블에도 같은 필터 조건이 추가된 다.

조건절이행을 통해 아래와 같은 쿼리로 형태가 변환된 것이다.

```sql
select *
from dept d, emp e
where e.job = 'MANAGER'
and e.deptno = 10
and d.deptno = 10
```

위와 같이 변환한다면, 해시 조인 또는 소트 머지 조인을 수행하기 전에 Emp와 Dept 테이블에 각각 필터링을 적용하여 조인되는 데이터량을 줄일 수 있다.

dept 테이블 액세스를 위한 인덱스 사용을 추가로 고려할 수 있게 돼 더 나은 실행계획을 수립할 가능성도 커진다.

새로운 필터 조건이 추가되면서 기존에 있던 조인 조건이 제거되는데 이는 쿼리 수행 시 예상 비용을 더 적확히 계산하기 위한 조치다.

필터 또는 조인 조건이 하나씩 추가될 때마다 카디널리티 예상치가 감소하고, 전체 쿼리 수행비용도 낮게 평가된다.

```sql
select *
from 상품이력 a, 주문 b
where b.거래일자 between '20090101' and '20090131'
and a.상품번호 = b.상품번호
and b.거래일자 between a.시작일자 and a.종료일자
```

특정 주문 데이터를 조회하면서 선분이력으로 설계된 상품이력 테이블을 Between 조건으로 조인하는 쿼리이다.

선분이력을 between으로 조회할 때는 인덱스 구성과 검색 범위에 따라 인덱스 스캔 효율에 많은 차이가 생긴다.

따라서 가급적 검색 범위를 제한해 주는 것이 도움이 되는데, 위 쿼리에서는 검색 범위가 주문 테이블에만 있다.

하지만 조건절을 분석해 보면 선분이력 조건에도 범위를 더 제한적으로 줄 수 있는 방법이 있다.

상품이력에서도 주문의 조건절에 쓰인 특정 기간에 해당하는 이력만 읽으면 된다.

시작일자가 '20090131' 보다 작고, 종료일자가 '20090101' 보다 크다는 것이다.

따라서 이 조건절을 명시적으로 넣어주면 상품이력에서 읽는 데이터량을 줄일 수 있다.

\- 상품이력.시작일자 <= '20090131'
\- 상품이력.종료일자 >= '20090101'

9i 부터 옵티마이저가 이들 조건을 묵시적으로 추가하고 최적화를 수행한다.

이처럼 상품이력에 추가조건절을 생성해 줄 수 있는 것은, 조인문에 사용된 조건절 때문이다.

```sql
-- IP주소목록_PK : IP주소
-- IP주소목록_X01 : 시작IP주소
SELECT ...
FROM IP주소목록
WHERE 시작IP주소 >= :strtIpAddr
AND 종료IP주소 <= :endIpAddr
```

2000만개의 IP주소목록을 관리하는 테이블에서 특정 서브넷에 속한 IP목록을 조회하기 위해 사용하는 쿼리이다.

바인드 변수에 아래와 같은 값이 입력되면 '192.168.000' 서브넷에 속한 IP 주소목록을 가져온다.

```sql
:strtIpAddr := '192.168.000.001'
:endIpAddr := '192.168.000.255'
```

위 쿼리를 수행하면 IP주소목\_Xo1 인덱스를 하고 테이블을 엑세스하는 과정에서 약 700만번의 테이블엑세스가 발생한다.

튜닝을위해 IP주소목록\_X01 인덱스에 종료IP주소 컬럼을 추가하는 방안을 고려할 수 있다.

그런데 인덱스를 스캔하는과정에서 이미 다수의 I/O가 발생했는데 여기에 종료IP주소 컬럼까지 추가하면 인덱스의 크기가 증가하므로 스캔량은 더 늘어난다.

IP주소목윽 테이블에 입력된 종료 IP 주소는 시작IP주소보다 항상크다. 이 정보를 추가해주면 인덱스 스캔량을 획기적으로 줄일 수 있다.

```sql
-- IP주소목록_PK : IP주소
-- IP주소목록_X01 : 시작IP주소
SELECT ...
FROM IP주소목록
WHERE 시작IP주소 >= :strtIpAddr
AND 종료IP주소 <= :endIpAddr
AND 시작IP주소 <= 종료IP주소
```

이를 시작IP주소, 종료IP주소 컬럼 기준으로 다시분해하면 아래와 같은 조건식이 만들어진다.

```sql
where 시작IP주소 BETWEEN :strIpAddr AND :endIpAddr
where 종료IP주소 BETWEEN :strIpAddr AND :endIpAddr
```

이를 통해 시작IP주소만으로도 검색 범위를 크게 줄일 수 있다.

상수 및 변수에 대한 조건절은 조인문을 타고 다른 쪽 테이블로 전이된다. 하지만 조인문 자체는 전이되지 않으므로 최적의 조인순서를 결정하고

그 순서에 따라 조인문을 기술해 주는 것이 매우 중요하다.
